version: "3.8"

services:
  excalidraw:
    image: ghcr.io/betterandbetterii/excalidraw-full:latest
    restart: unless-stopped

    ports:
      - "3002:3002"

    environment:
      SERVICE_URL_EXCALIDRAW_3002: "http://excalidraw:3002"

      GITHUB_CLIENT_ID: ${GITHUB_CLIENT_ID}
      GITHUB_CLIENT_SECRET: ${GITHUB_CLIENT_SECRET}
      GITHUB_REDIRECT_URL: ${GITHUB_REDIRECT_URL}

      JWT_SECRET: ${JWT_SECRET}

      STORAGE_TYPE: s3
      S3_BUCKET_NAME: ${S3_BUCKET_NAME}
      AWS_ACCESS_KEY_ID: ${AWS_ACCESS_KEY_ID}
      AWS_SECRET_ACCESS_KEY: ${AWS_SECRET_ACCESS_KEY}
      AWS_REGION: auto
      S3_ENDPOINT: ${S3_ENDPOINT}
      S3_FORCE_PATH_STYLE: "true"

      OPENAI_API_KEY: ${OPENAI_API_KEY}

    volumes: []
    depends_on: []
    labels: {}

    healthcheck:
      test: ["CMD", "wget", "--spider", "--quiet", "http://localhost:3002"]
      interval: 10s
      timeout: 5s
      retries: 10
